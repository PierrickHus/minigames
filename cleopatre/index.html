<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cl√©op√¢tre - Le Village du Nil</title>
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/scenario.css">
</head>
<body>
    <a href="../index.html" id="backButton">‚Üê Menu</a>

    <!-- Menu Principal -->
    <div id="mainMenu" class="screen active">
        <div class="menu-content">
            <h1>üèõÔ∏è CL√âOP√ÇTRE üèõÔ∏è</h1>
            <h2>Le Village du Nil</h2>
            <div class="menu-buttons">
                <button data-action="newGame">Nouvelle Partie</button>
                <button data-action="startTutorial">Tutoriel</button>
                <button data-action="showScenarios" id="scenariosBtn" disabled title="Aucun sc√©nario suppl√©mentaire disponible">Sc√©narios</button>
                <button data-action="loadGame" id="loadBtn" disabled>Charger</button>
                <button data-action="showGuide">Guide du Jeu</button>
                <button data-action="showSettings">Parametres</button>
            </div>
        </div>
        <div class="menu-footer">
            <p>Construisez et g√©rez votre village pour Cl√©op√¢tre</p>
        </div>
    </div>

    <!-- S√©lection du sc√©nario (pour futurs sc√©narios) -->
    <div id="scenarioSelect" class="screen">
        <h1 class="scenario-select-title">Sc√©narios</h1>
        <p class="scenario-select-subtitle">Aucun sc√©nario suppl√©mentaire disponible pour le moment</p>
        <div class="scenario-cards" id="scenarioCards">
            <!-- Les cartes seront g√©n√©r√©es quand d'autres sc√©narios seront ajout√©s -->
        </div>
        <button class="scenario-back-btn" data-action="showMenu">Retour au Menu</button>
    </div>

    <!-- S√©lection du personnage -->
    <div id="characterSelect" class="screen">
        <h1>Choisissez votre Chef de Village</h1>
        <div class="character-grid">
            <div class="character-card" data-gender="male">
                <div class="character-icon">üë®</div>
                <div class="character-name">Chef du Village</div>
                <div class="character-desc">Un homme sage et d√©termin√©</div>
            </div>
            <div class="character-card" data-gender="female">
                <div class="character-icon">üë©</div>
                <div class="character-name">Cheffe du Village</div>
                <div class="character-desc">Une femme courageuse et avis√©e</div>
            </div>
        </div>
        <button class="back-btn" data-action="showMenu">Retour</button>
    </div>

    <!-- √âcran de Jeu Principal -->
    <div id="gameScreen" class="screen">
        <!-- Barre sup√©rieure -->
        <div id="topBar">
            <div class="resources">
                <span id="moneyDisplay" title="Argent">üí∞ 1000</span>
                <span id="foodDisplay" title="Nourriture">üçû 0</span>
                <span id="waterDisplay" title="Eau">üíß 0</span>
                <span id="populationDisplay" title="Population">üë• 100</span>
                <span id="peasantsDisplay" title="Paysans disponibles">üßë‚Äçüåæ 10</span>
                <span id="rationTimerDisplay" class="ration-timer" title="Prochaine ration">üçΩÔ∏è 1:00</span>
                <span id="growthTimerDisplay" class="growth-timer hidden" title="Prochaine croissance">üìà 1:00</span>
            </div>
            <div class="goal-info" id="goalContainer">
                <span id="goalDisplay">Objectif: 10 000 habitants</span>
                <div id="goalTooltip" class="goal-tooltip hidden">
                    <div class="goal-tooltip-header">Conditions</div>
                    <div id="goalVictoryConditions" class="goal-section">
                        <div class="goal-section-title">üèÜ Victoire</div>
                        <ul id="victoryConditionsList"></ul>
                    </div>
                    <div id="goalDefeatConditions" class="goal-section">
                        <div class="goal-section-title">üíÄ D√©faite</div>
                        <ul id="defeatConditionsList"></ul>
                    </div>
                </div>
            </div>
            <div class="actions">
                <div class="save-group">
                    <button data-action="saveGame">Sauvegarder</button>
                    <label class="autosave-switch" title="Sauvegarde automatique toutes les 2 minutes">
                        <input type="checkbox" id="autoSaveToggle">
                        <span class="autosave-slider"></span>
                        <span class="autosave-label">Auto</span>
                    </label>
                </div>
                <button data-action="showMenu">Menu</button>
            </div>
        </div>

        <!-- Zone de jeu principale (contient canvas + panneau d'actions) -->
        <div id="gameArea">
            <!-- Zone du village avec canvas -->
            <div id="villageArea">
                <canvas id="villageCanvas"></canvas>

                <!-- Panneau de Cl√©op√¢tre (overlay sur le canvas) -->
                <div id="cleopatraPanel">
                    <div class="cleopatra-portrait">
                        <div class="portrait-frame">üëë</div>
                    </div>
                    <div class="cleopatra-info">
                        <div class="cleopatra-message">
                            <div class="message-header">Cl√©op√¢tre</div>
                            <div id="cleopatraText">Bienvenue, chef de village. J'attends beaucoup de vous.</div>
                        </div>
                        <div class="cleopatra-mood">
                            <span class="mood-label">Humeur:</span>
                            <div class="mood-bar-container">
                                <div id="moodBar" class="mood-bar"></div>
                            </div>
                            <span id="cleopatraMood" class="mood-value">50%</span>
                        </div>
                    </div>
                    <div id="nextTaskTimer" class="next-task-timer hidden">
                        <span class="next-task-label">Prochaine mission:</span>
                        <span id="nextTaskCountdown">--</span>
                    </div>
                    <div id="currentTask">
                        <div class="task-header-row">
                            <div class="task-header">T√¢ches de Cl√©op√¢tre:</div>
                            <label class="toggle-switch" title="Envoi automatique des ressources">
                                <input type="checkbox" id="autoSendGlobal" autocomplete="off">
                                <span class="slider"></span>
                                <span class="switch-label">Auto</span>
                            </label>
                        </div>
                        <div id="taskDescription"></div>
                    </div>
                </div>
            </div>

            <!-- Panneau d'actions (√† droite) -->
            <div id="actionPanel">
            <div class="panel-tabs">
                <button class="tab-btn active" data-tab="buildings">B√¢timents</button>
                <button class="tab-btn" data-tab="tasks">T√¢ches</button>
                <button class="tab-btn" data-tab="stats">Stats</button>
            </div>

            <!-- Onglet B√¢timents -->
            <div id="buildingsTab" class="tab-content active">
                <div id="buildingsList"></div>
            </div>

            <!-- Onglet T√¢ches -->
            <div id="tasksTab" class="tab-content">
                <div id="tasksList"></div>
            </div>

            <!-- Onglet Statistiques (r√©sum√©) -->
            <div id="statsTab" class="tab-content">
                <div class="stats-section">
                    <h4>Alertes</h4>
                    <div id="statsAlerts"></div>
                </div>
                <div class="stats-section">
                    <h4>Aper√ßu rapide</h4>
                    <div id="statsProduction"></div>
                </div>
                <button id="openStatsMenu" class="open-stats-btn">
                    üìä Voir les statistiques d√©taill√©es
                </button>
            </div>
        </div>

        <!-- Panneau lat√©ral d'info -->
        <div id="sidePanel" class="hidden">
            <div id="sidePanelContent"></div>
            <button class="close-btn close-btn-sm" data-action="closeSidePanel">‚úï</button>
        </div>
    </div>

        <!-- Panneau de ressources (fixe en bas) -->
        <div id="resourcesBar">
            <div class="resources-bar-content">
                <!-- Multiplicateur -->
                <div class="resources-multiplier">
                    <span class="mult-label">Ouvriers:</span>
                    <div class="mult-buttons" id="resourceMultiplierBar">
                        <button type="button" class="mult-btn active" data-mult="1">x1</button>
                        <button type="button" class="mult-btn" data-mult="5">x5</button>
                        <button type="button" class="mult-btn" data-mult="10">x10</button>
                        <button type="button" class="mult-btn" data-mult="max">Max</button>
                    </div>
                </div>

                <!-- Liste des ressources -->
                <div class="resources-list" id="resourcesBarList">
                    <!-- Bois -->
                    <div class="resource-bar-item clickable" data-resource="wood">
                        <div class="resource-bar-icon">ü™µ</div>
                        <div class="resource-bar-info">
                            <div class="resource-bar-header">
                                <span class="resource-bar-name">Bois</span>
                                <span class="resource-bar-yield">+10</span>
                            </div>
                            <div class="resource-bar-stock">
                                <span id="woodStockBar">0</span>
                                <span id="woodPendingBar" class="resource-bar-pending"></span>
                            </div>
                        </div>
                        <div class="resource-bar-cost">
                            <span class="cost-value">üí∞5</span>
                            <span class="cost-time">15s</span>
                        </div>
                        <div class="resource-bar-progress hidden">
                            <div class="progress-fill"></div>
                            <span class="progress-text">0%</span>
                        </div>
                    </div>

                    <!-- Pierre -->
                    <div class="resource-bar-item clickable" data-resource="stone">
                        <div class="resource-bar-icon">ü™®</div>
                        <div class="resource-bar-info">
                            <div class="resource-bar-header">
                                <span class="resource-bar-name">Pierre</span>
                                <span class="resource-bar-yield">+8</span>
                            </div>
                            <div class="resource-bar-stock">
                                <span id="stoneStockBar">0</span>
                                <span id="stonePendingBar" class="resource-bar-pending"></span>
                            </div>
                        </div>
                        <div class="resource-bar-cost">
                            <span class="cost-value">üí∞8</span>
                            <span class="cost-time">20s</span>
                        </div>
                        <div class="resource-bar-progress hidden">
                            <div class="progress-fill"></div>
                            <span class="progress-text">0%</span>
                        </div>
                    </div>

                    <!-- Sable -->
                    <div class="resource-bar-item clickable" data-resource="sand">
                        <div class="resource-bar-icon">üèúÔ∏è</div>
                        <div class="resource-bar-info">
                            <div class="resource-bar-header">
                                <span class="resource-bar-name">Sable</span>
                                <span class="resource-bar-yield">+15</span>
                            </div>
                            <div class="resource-bar-stock">
                                <span id="sandStockBar">0</span>
                                <span id="sandPendingBar" class="resource-bar-pending"></span>
                            </div>
                        </div>
                        <div class="resource-bar-cost">
                            <span class="cost-value">üí∞3</span>
                            <span class="cost-time">10s</span>
                        </div>
                        <div class="resource-bar-progress hidden">
                            <div class="progress-fill"></div>
                            <span class="progress-text">0%</span>
                        </div>
                    </div>

                    <!-- Terre -->
                    <div class="resource-bar-item clickable" data-resource="dirt">
                        <div class="resource-bar-icon">üü§</div>
                        <div class="resource-bar-info">
                            <div class="resource-bar-header">
                                <span class="resource-bar-name">Terre</span>
                                <span class="resource-bar-yield">+12</span>
                            </div>
                            <div class="resource-bar-stock">
                                <span id="dirtStockBar">0</span>
                                <span id="dirtPendingBar" class="resource-bar-pending"></span>
                            </div>
                        </div>
                        <div class="resource-bar-cost">
                            <span class="cost-value">üí∞4</span>
                            <span class="cost-time">12s</span>
                        </div>
                        <div class="resource-bar-progress hidden">
                            <div class="progress-fill"></div>
                            <span class="progress-text">0%</span>
                        </div>
                    </div>

                    <!-- Argile -->
                    <div class="resource-bar-item clickable" data-resource="clay">
                        <div class="resource-bar-icon">üß±</div>
                        <div class="resource-bar-info">
                            <div class="resource-bar-header">
                                <span class="resource-bar-name">Argile</span>
                                <span class="resource-bar-yield">+6</span>
                            </div>
                            <div class="resource-bar-stock">
                                <span id="clayStockBar">0</span>
                                <span id="clayPendingBar" class="resource-bar-pending"></span>
                            </div>
                        </div>
                        <div class="resource-bar-cost">
                            <span class="cost-value">üí∞10</span>
                            <span class="cost-time">25s</span>
                        </div>
                        <div class="resource-bar-progress hidden">
                            <div class="progress-fill"></div>
                            <span class="progress-text">0%</span>
                        </div>
                    </div>

                    <!-- Oiseaux (affichage sp√©cial) -->
                    <div class="resource-bar-item bird-bar-item" data-resource="birds">
                        <div class="resource-bar-icon">üïäÔ∏è</div>
                        <div class="resource-bar-info">
                            <div class="resource-bar-name">Oiseaux</div>
                            <div class="resource-bar-stock"><span id="birdsStockBar">0/0</span></div>
                        </div>
                        <div class="resource-bar-cost bird-cost">
                            <span class="cost-value">Auto</span>
                            <span class="cost-time" id="birdProductionTime">3min/üïäÔ∏è</span>
                        </div>
                        <div class="bird-progress-bar">
                            <div class="bird-progress-fill" id="birdProgressFill"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- √âcran Guide -->
    <div id="guideScreen" class="screen">
        <div id="guideHeader">
            <h1>Guide du Jeu</h1>
            <button class="close-btn" data-action="closeGuide">‚úï</button>
        </div>
        <div id="guideContent"></div>
    </div>

    <!-- √âcran Game Over -->
    <div id="gameOverScreen" class="screen">
        <div class="gameover-content">
            <div id="gameOverSprite" class="end-screen-sprite"></div>
            <h1 id="gameOverTitle">GAME OVER</h1>
            <p id="gameOverMessage"></p>
            <button data-action="showMenu">Retour au Menu</button>
        </div>
    </div>

    <!-- √âcran Victoire -->
    <div id="victoryScreen" class="screen">
        <div class="victory-content">
            <div id="victorySprite" class="end-screen-sprite"></div>
            <h1>üéâ VICTOIRE ! üéâ</h1>
            <p id="victoryMessage">F√©licitations ! Vous avez atteint l'objectif !</p>
            <p>Cl√©op√¢tre est fi√®re de vous et vous couvre d'or et de gloire.</p>
            <div id="victoryStats"></div>
            <button data-action="showMenu">Retour au Menu</button>
        </div>
    </div>

    <!-- Notifications -->
    <div id="notifications"></div>

    <!-- Tooltip -->
    <div id="tooltip" class="hidden"></div>

    <!-- Modal de confirmation -->
    <div id="confirmModal" class="modal hidden">
        <div class="modal-content">
            <h3 id="confirmTitle">Confirmation</h3>
            <p id="confirmMessage"></p>
            <div class="modal-buttons">
                <button type="button" id="confirmYes">Oui</button>
                <button type="button" id="confirmNo">Non</button>
            </div>
        </div>
    </div>

    <!-- M√©ga Menu Statistiques -->
    <div id="statsOverlay" class="stats-overlay hidden">
        <div class="stats-mega-menu">
            <div class="stats-header">
                <h2>üìä Statistiques du Village</h2>
                <button type="button" class="close-btn" id="closeStatsMenu">‚úï</button>
            </div>

            <div class="stats-content">
                <!-- Colonne gauche: Graphiques -->
                <div class="stats-column stats-graphs">
                    <div class="stats-card">
                        <h3>√âvolution des ressources</h3>
                        <div class="graph-tabs">
                            <button type="button" class="graph-tab active" data-resource="money">üí∞ Or</button>
                            <button type="button" class="graph-tab" data-resource="food">üçû Nourriture</button>
                            <button type="button" class="graph-tab" data-resource="water">üíß Eau</button>
                            <button type="button" class="graph-tab" data-resource="population">üë• Population</button>
                        </div>
                        <div class="graph-zoom">
                            <span class="zoom-label">P√©riode:</span>
                            <button type="button" class="zoom-btn" data-zoom="60">1min</button>
                            <button type="button" class="zoom-btn active" data-zoom="300">5min</button>
                            <button type="button" class="zoom-btn" data-zoom="600">10min</button>
                            <button type="button" class="zoom-btn" data-zoom="1800">30min</button>
                            <button type="button" class="zoom-btn" data-zoom="3600">1h</button>
                        </div>
                        <div class="graph-container">
                            <canvas id="resourceGraph"></canvas>
                        </div>
                        <div class="graph-legend" id="graphLegend"></div>
                    </div>

                    <div class="stats-card">
                        <h3>R√©partition des b√¢timents</h3>
                        <div class="graph-container graph-small">
                            <canvas id="buildingsGraph"></canvas>
                        </div>
                        <div id="buildingsLegend" class="buildings-legend"></div>
                    </div>
                </div>

                <!-- Colonne droite: Donn√©es -->
                <div class="stats-column stats-data">
                    <div class="stats-card">
                        <h3>Production actuelle</h3>
                        <div id="megaStatsProduction"></div>
                    </div>

                    <div class="stats-card">
                        <h3>Production th√©orique (b√¢timents)</h3>
                        <div id="megaStatsTheoretical"></div>
                    </div>

                    <div class="stats-card">
                        <h3>Alertes & Pr√©visions</h3>
                        <div id="megaStatsAlerts"></div>
                    </div>

                    <div class="stats-card">
                        <h3>Statistiques g√©n√©rales</h3>
                        <div id="megaStatsGeneral"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script type="module" src="src/main.js"></script>
</body>
</html>
